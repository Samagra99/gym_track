<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<!-- Recommended viewport for mobile; initial-scale helps stop some auto-zoom behavior -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Workout Tracker — Mobile Fix</title>

<!-- (Firebase scripts omitted here — add back your firebase SDKs and config if needed) -->

<style>
/* -------------------------
   Defensive mobile-first CSS
   ------------------------- */
:root{
  --bg:#f7f8fb; --card:#ffffff; --accent:#2563eb; --muted:#6b7280; --ok:#10b981;
  --danger:#ef4444; --glass: rgba(0,0,0,0.04);
}

/* Make sure nothing forces overflow */
html,body { max-width:100%; width:100%; overflow-x:hidden; margin:0; padding:0; height:100%; -webkit-text-size-adjust:100%; }

/* Base typography compact but legible */
body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background:var(--bg); color:#111; font-size:15px; line-height:1.3; padding:6px;
}

/* Prevent auto-zoom on focus by using at least 16px on form controls */
input, textarea, select, button {
  font-size: 16px;           /* very important to avoid mobile auto-zoom on focus */
  line-height: 1.2;
  -webkit-text-size-adjust:100%;
}

/* layout container */
.wrap { max-width:900px; margin:0 auto; padding:0 8px; box-sizing:border-box; }

/* header */
header{ display:flex; justify-content:space-between; align-items:center; gap:8px; margin:8px 0; flex-wrap:wrap; }
h1{ font-size:16px; margin:0; }
.controls{ display:flex; gap:8px; align-items:center; }

/* nav/date compact */
.nav-btn{ padding:6px 8px; border-radius:8px; border:1px solid var(--glass); background:transparent; font-size:14px; }
.date-display{ padding:6px 8px; border-radius:8px; background:#fff; box-shadow:0 1px 2px rgba(0,0,0,0.04); font-weight:600; font-size:13px; }

/* main responsive grid */
main{ display:grid; grid-template-columns: 1fr 320px; gap:12px; align-items:start; }

/* card & sessions compact */
.card{ background:var(--card); border-radius:10px; padding:8px; box-shadow:0 6px 14px rgba(16,24,40,0.03); }
.session{ margin-bottom:8px; padding:8px; border-radius:8px; border:1px solid var(--glass); }
.session h3{ margin:0 0 6px 0; font-size:15px; }
.exercise-list{ list-style:none; margin:0; padding:0; }
.exercise-list li{ display:flex; gap:8px; align-items:flex-start; padding:6px 6px; border-top:1px dashed rgba(0,0,0,0.04); font-size:14px; }
.exercise-list li:first-child{ border-top:0; }
.exercise-list li label span{ display:block; word-break:break-word; white-space:normal; }

/* buttons */
.large-btn{ padding:9px 12px; border-radius:10px; font-weight:600; font-size:15px; }
.complete{ background:linear-gradient(90deg,var(--ok),#0ea5a4); color:#fff }
.incomplete{ background:#fff; color:var(--muted); border:1px dashed var(--glass) }

/* progress */
.progress{ height:10px; background:linear-gradient(90deg,#e6eefc,#f3f7ff); border-radius:999px; overflow:hidden; border:1px solid var(--glass); }
.progress > i{ display:block; height:100%; background:linear-gradient(90deg,var(--accent),#7dd3fc); width:0%; }

/* 30-day compact grid */
.month-grid{ display:flex; gap:6px; align-items:flex-end; height:96px; padding:6px 4px; overflow-x:auto; -webkit-overflow-scrolling:touch; }
.day-col{ flex:0 0 18px; text-align:center; }
.bar{ width:100%; border-radius:6px; background:linear-gradient(180deg,var(--accent),#60a5fa); }

/* export area */
.export-area{ width:100%; height:96px; padding:8px; border-radius:8px; border:1px dashed var(--glass); background:#fafafa; font-family:monospace; font-size:13px; }

/* ---------- LOGIN SCREEN / OVERLAY STYLES (complete) ---------- */

/* overlay container covers full viewport and centers content */
#loginScreen{
  position: fixed;
  inset: 0;                       /* top:0; right:0; bottom:0; left:0 */
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  background: rgba(247,248,251,0.98); /* slightly translucent background */
  z-index: 9999;
  -webkit-overflow-scrolling: touch;
}

/* card inside overlay */
#loginScreen .login-card {
  width: 100%;
  max-width: 520px;
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(2,6,23,0.08);
  padding: 18px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  box-sizing: border-box;
}

/* headline and helper text */
#loginScreen h2 {
  margin: 0;
  font-size: 18px;
  line-height: 1.15;
}
#loginScreen .muted {
  color: var(--muted, #6b7280);
  font-size: 14px;
}

/* primary sign-in button */
#loginScreen button#googleLoginBtn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 10px 14px;
  font-size: 15px;
  border-radius: 8px;
  border: none;
  background: linear-gradient(90deg,var(--accent,#2563eb),#60a5fa);
  color: #fff;
  cursor: pointer;
  box-shadow: 0 6px 14px rgba(37,99,235,0.12);
}

/* small skip/close button for local testing — optional */
#loginScreen button#loginCloseBtn {
  align-self: flex-end;
  background: transparent;
  border: 0;
  color: var(--muted, #6b7280);
  font-size: 13px;
  padding: 6px;
  cursor: pointer;
}

/* keep focus styles visible for accessibility */
#loginScreen button:focus, #loginScreen a:focus {
  outline: 3px solid rgba(37,99,235,0.12);
  outline-offset: 3px;
  border-radius: 8px;
}

/* layout adjustments for very small screens */
@media (max-width: 420px) {
  #loginScreen .login-card { padding: 12px; border-radius: 10px; }
  #loginScreen h2 { font-size: 16px; }
  #loginScreen .muted { font-size: 13px; }
  #loginScreen button#googleLoginBtn { font-size: 14px; padding: 10px; }
}

/* utility: hide overlay quickly (JS toggles this class) */
#loginScreen.hidden { display: none !important; }

 
/* compact meta text */
.small{ font-size:12px; color:var(--muted); }

/* accessibility/focus */
button:focus, input:focus, textarea:focus { outline: 3px solid rgba(37,99,235,0.12); outline-offset:2px; }

/* ---------- Mobile adjustments (tighten spacing) ---------- */
@media (max-width:900px){
  body{ padding:6px; }
  main{ grid-template-columns: 1fr; gap:8px; }
  .card{ padding:8px; }
  .month-grid{ height:84px; gap:4px; }
  .day-col{ flex:0 0 24px; }
  .exercise-list li{ padding:8px 6px; font-size:15px; }
  .large-btn{ width:100%; padding:10px; }
  .session-actions{ display:flex; flex-direction:column; gap:8px; }
  .date-display{ font-size:13px; padding:6px 8px; }
}

/* very small devices - further shrink slightly */
@media (max-width:380px){
  html, body { font-size:14px; }
  .day-col{ flex:0 0 28px; }
  .month-grid{ height:74px; }
  .export-area{ height:80px; font-size:12px; }
}

/* final safety net: ensure no element wider than viewport */
*{ max-width:100vw; box-sizing:border-box; }
</style>
</head>
<body>

 <!-- LOGIN SCREEN -->
<div id="loginScreen">
  <div class="login-card">
    <button id="loginCloseBtn" title="Close (test only)">✕</button>   <!-- optional -->
    <h2>Sign in to sync your workout data</h2>
    <div class="muted">Your progress will be stored securely in Firestore.</div>
    <button id="googleLoginBtn">Sign in with Google</button>
  </div>
</div>

<div class="wrap">
  <header>
    <div>
      <h1>Workout Tracker</h1>
      <div class="small">Compact mobile layout</div>
    </div>

    <div class="controls">
      <div style="display:flex; gap:6px; align-items:center;">
        <button class="nav-btn" id="prevBtn" aria-label="Previous">&larr;</button>
        <button class="nav-btn" id="todayBtn">Today</button>
        <button class="nav-btn" id="nextBtn" aria-label="Next">&rarr;</button>
      </div>
      <div class="date-display" id="dateDisplay">—</div>
    </div>
  </header>

  <main>
    <section>
      <div class="card">
        <h2 id="dayTitle">Workout</h2>

        <div class="session">
          <h3>Morning Session</h3>
          <ul class="exercise-list" id="morningList">
            <li><label><input type="checkbox"> <span>Warm-up: 5 min brisk walk or light jog + dynamic stretches</span></label></li>
            <li><label><input type="checkbox"> <span>Jumping Jacks: 3 sets x 40 seconds (or 30 reps)</span></label></li>
            <li><label><input type="checkbox"> <span>Bodyweight Squats: 3 sets x 12-15 reps</span></label></li>
            <li><label><input type="checkbox"> <span>Plank: 3 sets x 30-45 seconds</span></label></li>
            <li><label><input type="checkbox"> <span>Standing Calf Raises: 3 sets x 20 reps</span></label></li>
            <li><label><input type="checkbox"> <span>Cool down: 3-5 minutes stretching</span></label></li>
          </ul>
          <div style="margin-top:8px;">
            <button class="large-btn incomplete" id="markMorning">Mark Morning Complete</button>
          </div>
        </div>

        <div class="session">
          <h3>Evening Session</h3>
          <ul class="exercise-list" id="eveningList">
            <li><label><input type="checkbox"> <span>Warm-up: 3-5 min light cardio + mobility</span></label></li>
            <li><label><input type="checkbox"> <span>Push-ups: 3 sets x 8-15 reps (modify on knees if needed)</span></label></li>
            <li><label><input type="checkbox"> <span>Glute Bridge: 3 sets x 12-15 reps</span></label></li>
            <li><label><input type="checkbox"> <span>Walking Lunges: 3 sets x 10-12 steps per leg</span></label></li>
            <li><label><input type="checkbox"> <span>Leg Raises (lying): 3 sets x 10-15 reps</span></label></li>
            <li><label><input type="checkbox"> <span>Optional finisher: 5-8 minutes steady cardio or core AMRAP</span></label></li>
            <li><label><input type="checkbox"> <span>Cool down: 3-5 minutes stretching</span></label></li>
          </ul>
          <div style="margin-top:8px;">
            <button class="large-btn incomplete" id="markEvening">Mark Evening Complete</button>
          </div>
        </div>

        <div style="margin-top:10px;">
          <div class="small">Daily Progress</div>
          <div class="progress" aria-hidden="true"><i id="dailyBar" style="width:0%"></i></div>
          <div class="small" id="dailyText" style="margin-top:6px">0% (0 of 0 exercises)</div>

          <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="pill" id="resetDay">Reset Day</button>
            <button class="pill" id="exportBtn">Export JSON</button>
            <button class="pill" id="importBtn">Import JSON</button>
            <button class="pill" id="clearAll" style="background:var(--danger); color:#fff;">Clear All</button>
          </div>
        </div>
      </div>
    </section>

    <aside>
      <div class="card">
        <h3>30-Day Progress</h3>
        <div class="small">Tap a bar to view that day</div>
        <div class="month-grid" id="monthGrid"><!-- bars added by JS --></div>

        <div style="margin-top:10px;">
          <div class="small">Overall</div>
          <div class="progress" style="margin-top:6px;"><i id="overallBar" style="width:0%"></i></div>
          <div class="small" id="overallText" style="margin-top:6px">0% complete</div>
        </div>

        <div style="margin-top:8px;">
          <textarea id="exportArea" class="export-area" placeholder="Exported JSON will appear here"></textarea>
        </div>
      </div>
    </aside>
  </main>

  <footer style="margin-top:8px; font-size:12px; color:#666;">Tip: Open in Chrome on Android. If layout still looks off, try a hard refresh or Incognito to clear cached CSS.</footer>
</div>

<script>
/* Defensive JS to remove accidental focus and reset scroll on load */
(function(){
  // Blur any element that might have focus on load (prevents some devices from auto-zooming to a focused control)
  window.addEventListener('load', function(){ 
    try{ if(document.activeElement) document.activeElement.blur(); }catch(e){}
    // small scroll reset after a tick
    setTimeout(()=>{ try{ window.scrollTo(0,0); }catch(e){} }, 50);
  });

  // Extra: dynamically slightly reduce font-size on very narrow viewports to avoid overflow
  function adjustFont(){
    var w = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    if(w < 360){
      document.documentElement.style.fontSize = '14px';
    } else {
      document.documentElement.style.fontSize = '';
    }
  }
  window.addEventListener('resize', adjustFont);
  adjustFont();
})();

/* Minimal interactive JS for demo so you can test quickly */
(function(){
  // compute total exercises from static DOM lists
  function countExercises(){
    const morning = document.querySelectorAll('#morningList li').length;
    const evening = document.querySelectorAll('#eveningList li').length;
    return { morning, evening, total: morning + evening };
  }
  function updateProgress(){
    const checks = document.querySelectorAll('#morningList input[type=checkbox], #eveningList input[type=checkbox]');
    let done = 0;
    checks.forEach(cb => { if(cb.checked) done++; });
    const totals = countExercises();
    const pct = totals.total===0 ? 0 : Math.round((done / totals.total) * 100);
    document.getElementById('dailyBar').style.width = pct + '%';
    document.getElementById('dailyText').textContent = pct + '% ('+done+' of '+totals.total+' exercises)';
    // update monthGrid mock bars (simple arith)
    renderMonthGridMock(done, totals.total);
    document.getElementById('overallText').textContent = pct + '% complete';
  }
  // attach checkbox listener
  document.querySelectorAll('#morningList input[type=checkbox], #eveningList input[type=checkbox]').forEach(cb=>{
    cb.addEventListener('change', updateProgress);
  });

  // mark morning/evening toggles
  document.getElementById('markMorning').addEventListener('click', ()=>{
    const list = document.querySelectorAll('#morningList input[type=checkbox]');
    const all = Array.from(list).every(i=>i.checked);
    list.forEach(i=> i.checked = !all);
    updateProgress();
  });
  document.getElementById('markEvening').addEventListener('click', ()=>{
    const list = document.querySelectorAll('#eveningList input[type=checkbox]');
    const all = Array.from(list).every(i=>i.checked);
    list.forEach(i=> i.checked = !all);
    updateProgress();
  });

  document.getElementById('resetDay').addEventListener('click', ()=>{
    document.querySelectorAll('#morningList input,#eveningList input').forEach(i=> i.checked = false);
    updateProgress();
  });

  // month grid mock renderer: draws 30 bars scaled to current day's done count so you can test visuals
  function renderMonthGridMock(doneToday, total){
    const grid = document.getElementById('monthGrid');
    grid.innerHTML = '';
    for(let i=29;i>=0;i--){
      const d = new Date();
      d.setDate(d.getDate() - i);
      // create a demo percent - random-ish but include today's actual percent for the last column
      let pct = Math.max(0, Math.round(((i===0 ? doneToday : ((Math.abs(Math.sin(d.getDate()))*total)|0)) / total) * 100));
      const col = document.createElement('div');
      col.className = 'day-col';
      col.innerHTML = '<div style="height:84px;display:flex;align-items:flex-end;"><div class="bar" style="height:'+pct+'%"></div></div><div class="day-label">'+d.getDate()+'</div>';
      (function(dateCopy){
        col.addEventListener('click', function(){
          // navigate to that date -- for demo this simply alerts
          alert('Open date: ' + dateCopy.toDateString());
        });
      })(new Date(d));
      grid.appendChild(col);
    }
  }

  // initial render
  updateProgress();

  // navigation demo
  document.getElementById('prevBtn').addEventListener('click', ()=> alert('Prev day (demo)'));
  document.getElementById('nextBtn').addEventListener('click', ()=> alert('Next day (demo)'));
  document.getElementById('todayBtn').addEventListener('click', ()=> alert('Go to today (demo)'));

  // export/import/clear mock behavior
  document.getElementById('exportBtn').addEventListener('click', ()=>{
    const state = { demo: 'this is a demonstration export' };
    document.getElementById('exportArea').value = JSON.stringify(state, null, 2);
    alert('Exported to text area (demo).');
  });
  document.getElementById('importBtn').addEventListener('click', ()=>{
    alert('Import (demo) - paste JSON into the box then press import in the final version.');
  });
  document.getElementById('clearAll').addEventListener('click', ()=>{
    if(confirm('Clear all data (demo)?')){
      document.querySelectorAll('#morningList input,#eveningList input').forEach(i=> i.checked = false);
      updateProgress();
      document.getElementById('exportArea').value = '';
    }
  });

})();
</script>
</body>
</html>
